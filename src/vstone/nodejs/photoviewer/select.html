<!DOCTYPE html>
<html>
<head>
<title>CSS Animation</title>
<meta content="text/html; charset=utf-8" http-equiv="content-type">

<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="format-detection" content="telephone=no">
<link media="only screen and (max-device-width:480px)" href="../css/smart.css" type="text/css" rel="stylesheet" />
<link media="screen and (min-device-width:481px)" href="../css/pc.css" type="text/css" rel="stylesheet" />
<!--[if IE]>
<link href="../css/pc.css" type="text/css" rel="stylesheet" />
<![endif]-->


</head>
<body>
	<div class="navibar" >
			<div class="menu"  id="back_button"><img src="../img/sq_prev_icon&48.png"/ ><span>è¬Œï½»ç¹§?¿½</span></div>
			<div class="menu"  id="selectall_button"><img src="../img/checkbox_checked_icon&48.png"/><span>èœˆï½¨é©•ï½¸è¬šï¿½</span></div>
			<div class="menu"  id="download_button"><img src="../img/download_icon&48.png"/><span>ç¹ï¿½ç¹§?½¦ç¹ï½³ç¹ï½­ç¹ï½¼ç¹ï¿½</span></div>
			<div class="menu"  id="remove_button"><img src="../img/trash_icon&48.png"/><span>èœ‘ä¼å‹</span></div>
	</div>

	<div class="imgFit" id="lightgallery" data-lightbox="image-set">

		{photolist}

	</div>

	<script src="../js/jquery-2.1.4.min.js"></script>
	<script src='../js/jquery.imagefit.js'></script>
	<script src='../js/touchhouver.js'></script>
	
	<script>
	
	var selected = new Array();
	
		$(document).ready(function() {
			
				[].forEach.call(document.getElementsByClassName("cover"),
					function(element) {
							element.addEventListener(
							'click',
							function(event) {
								var eventParent = element.parentNode;
								
								eventParent.style.backgroundColor = '#2ecc71';
								selected.push(eventParent.getAttribute("file"));
								console.log("cover click " + eventParent.id);
							}, false);
					});

				document.getElementById("remove_button").addEventListener(
						'click',
						function(event) {
							console.log("remove_button click");
							for (i = 0; i <selected.length; i++) {
								console.log(selected[i]);
						    }
							    $.ajax({
							        url: "remove.php",
							        dataType: 'text',
							        type:"POST",
							        data: {
							            "remove_data": selected
							        }
							    });

								document.location = "index.html";
						}, false);
				document.getElementById("download_button").addEventListener(
						'click',
						function(event) {
							console.log("download_button click");
							for (i = 0; i < selected.length; i++) {
								var filename = selected[i].substring(selected[i].lastIndexOf('/')+1, selected[i].length);
								console.log(selected[i]);
								console.log(filename);
								downloadAsFile(filename,selected[i]);
						    }
							document.location = "index.html";
						}, false);
				
				document.getElementById("back_button").addEventListener(
						'click',
						function(event) {
							console.log("back_button click");
							history.back(-1);
						}, false);
				
				document.getElementById("selectall_button").addEventListener(
						'click',
						function(event) {
							console.log("selectall_button click");
							
							 selected = new Array();
							[].forEach.call(document.getElementsByClassName("aspectwrapper"),
								function(element) {
								element.style.backgroundColor = '#2ecc71';
								selected.push(element.getAttribute("file"));
							});
							
						}, false);
				
			});

		$(window).load(function() {
			$('.imgFit a').imagefit({
				mode : 'inside', //è¬–ï¿½è³å£¹ã—ç¹§?½¤ç¹§?½ºç¸º?½®è³?½­ç¸º?½«èœˆï½¥ç¹§å¾Œï½‹ç¸ºä¹ï¿½?½¯ç¸º?½¿èœ?½ºç¸ºè¼”â—‹ç¹§ä¹Â°ç¸º?½®è¬–ï¿½è³?¿½: 'inside' or 'outside'.
				halign : 'center', //è¬–ï¿½è³å£¹ã—ç¹§?½¤ç¹§?½ºç¸º?½®ç¹æ‚¶ÎŸç¹ï¿½ç¹§?½¯ç¸º?½«èŸ?½¾ç¸ºå¶?½‹é?•ï½»èœ’ä¸Šï¿½?½®é©Ÿå’²?½½?½®è®“ï½ªè´å’²?½½?½®: 'left', 'center' or 'right'
				valign : 'middle', //è¬–ï¿½è³å£¹ã—ç¹§?½¤ç¹§?½ºç¸º?½®ç¹æ‚¶ÎŸç¹ï¿½ç¹§?½¯ç¸º?½«èŸ?½¾ç¸ºå¶?½‹é?•ï½»èœ’ä¸Šï¿½?½®é©Ÿå’²?½½?½®é‚µ?½¦è´å’²?½½?½®: 'top', 'middle' or 'bottom'
				force : false
			//é€•ï½»èœ’ä¸Šï¿½?½®ç¹§?½µç¹§?½¤ç¹§?½ºç¸ºæ¢§æ¬?è³å£¹ã—ç¹§?½¤ç¹§?½ºç¹§åŒ»?½ŠèŸ†ä¸Šï¼?ç¸º?¿½è£?½´èœ·åŒ»?½‚ç¹ï½ªç¹§?½µç¹§?½¤ç¹§?½ºç¸ºå¶?½‹ç¸ºä¹â?ç¸º?¿½ç¸º?¿½:true or false 
			});
		});
		/*
		function downloadAsFile(fileName, content) {
			var blob = new Blob([ content ]);
			var url = window.URL || window.webkitURL;
			var blobURL = url.createObjectURL(blob);

			console.log("blobURL:"+blobURL);
			var a = document.createElement('a');
			a.download = fileName;
			a.href = blobURL;
			a.click();
		};
		*/
		
		function downloadAsFile(fileName, content) {
			var a = document.createElement('a');
			a.download = fileName;
			a.href = content;
			a.click();
		};

		function absolutePath(path) {
			var e = document.createElement('span');
			e.innerHTML = '<a href="' + path + '" />';
			return e.firstChild.href;
		}
		
		
		
	</script>
</body>
</html>